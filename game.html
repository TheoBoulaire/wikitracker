<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>WikiTracker</title>
        <meta name="description" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" type="image/svg" href="./images/logoW.svg">
        <link href="style/bootstrap.css" rel="stylesheet" />
        <!-- <link href="style/custom.css" rel="stylesheet" /> -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    </head>
    <body>
        <div id="app">
            <header class="container-fluid sticky-top border-bottom border-secondary border-2">
                <div class="row fs-2">
                    <div class="col-2 fs-2">
                        <a href="/"><img src="./images/logoW.svg" id="logo" alt="Logo de l'application"></img></a>
                        <span id="wt-time" class="badge text-white align-text-bottom">
                            {{ timeDisplay }}
                        </span>
                        <span id="wt-distance" class="badge text-white align-text-bottom" 
                            v-bind:class="{ 'suboptimal': suboptimal === true }">
                            {{ distance + ((length > 0) ? " / " + length : "") }}
                        </span>
                        <!--
                        <button type="button" class="btn btn-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-left-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"></path>
                            </svg>
                        </button>
                        -->
                    </div>
                    <div class="col-10">
                        <nav class="d-inline-block align-middle" style="--bs-breadcrumb-divider: '>';" aria-label="Fil d'Ariane">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item" v-bind:class="{ past: pos !== 0 }" v-on:click="pos = 0;" 
                                    v-on:keydown="navBreadCrumbWithKeyboard($event, 0)" 
                                    tabindex="0" v-bind:aria-current="{ page: pos === 0 }">
                                    {{ start.label }}
                                </li>
                                <li v-for="(step, index) in track" class="breadcrumb-item" 
                                    v-bind:class="{ past: pos !== index + 1, 'goal': (index + 1 === track.length) && achieved }" 
                                    v-on:click="pos = index + 1;" v-on:keydown="navBreadCrumbWithKeyboard($event, index + 1)" 
                                    tabindex="0" :key="step.item.id" v-bind:aria-current="{ page: pos === index + 1 }">
                                    {{ step.item.label }}
                                </li>
                                <li v-if="!achieved" class="breadcrumb-item">
                                    •••
                                </li>
                                <li v-if="!achieved" class="breadcrumb-item goal" tabindex="0">
                                    {{ goal.label }}
                                </li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </header>
            <main class="container">
                <div v-if="errors.length > 0" class="alert alert-danger" role="alert">
                    <h2 class="alert-heading">Erreur</h2>
                    <p v-for="error of errors" class="fs-5">
                        {{ error }}
                    </p>
                </div>
                <div v-if="achieved" class="alert alert-success" role="alert">
                    <p class="fs-5">
                        {{
                            "\""
                                + start.label.charAt(0).toUpperCase() + start.label.slice(1)
                                + track.map(step => ", " + step.property.label + " " + step.item.label).reduce((acc, val) => acc + val)
                                + (language === "fr" ? "\" est un chemin sémantique." : "\" is a semantic path.")
                        }}
                    </p>
                </div>
                <div v-if="forward" class="fs-5">
                    <div v-for="(choice, index) in choices" v-on:click="choose($event, index)" 
                        v-on:keydown="chooseWithKeyboard($event, index)" class="row rounded wt-choice" 
                        :key="choice.property.id + choice.item.id" tabindex="0">
                        <div class="col-4 text-truncate text-end" :aria-label="choice.property.label">
                            {{ 
                                choice.property.order === 0 ?
                                    choice.property.label: 
                                    (
                                        choice.property.order === 1 ?
                                            "├":
                                            "└"
                                    ) + "─"
                            }}
                        </div>
                        <div class="col-8 wt-item text-truncate text-start">
                            {{ choice.item.label }}
                        </div>
                    </div>
                </div>
                <div v-else class="fs-5">
                    <div v-for="(choice, index) in choices" v-on:click="choose($event, index)" 
                        v-on:keydown="chooseWithKeyboard($event, index)" class="row rounded wt-choice" 
                        :key="choice.item.id + choice.property.id" tabindex="0">
                        <div class="col-4 wt-item text-truncate text-end">
                            {{ choice.item.label }}
                        </div>
                        <div class="col-8 text-truncate text-start" :aria-label="choice.property.label">
                            {{ 
                                choice.property.order === 0 ?
                                    ("─┬ " + choice.property.label): 
                                    "─" + (
                                        choice.property.order === 1 ?
                                            "┤":
                                            "┘"
                                    )
                            }}
                        </div>
                    </div>
                </div>
                <div class="progress bg-transparent fixed-bottom" v-bind:class="{ invisible: choicesLoadingProgress < 1 }">
                    <div class="progress-bar progress-bar-striped" role="progressbar" 
                        v-bind:style="'width: ' + this.choicesLoadingProgress + '%;'" v-bind:aria-valuenow="choicesLoadingProgress" 
                        aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </main>
        </div>
        <script src="scripts/exclusion.js"></script>
        <script src="scripts/app.js"></script>
    </body>
</html>